using System.Collections;
using System.Collections.Generic;
using System.Security.Cryptography.X509Certificates;
using UnityEngine;
using UnityEngine.Networking;

public class SslCertHandler : CertificateHandler
{
    private static string SRV_PUB_KEY = "3082020A0282020100CD8CAED7768E714F77D60B960021ACEFFF6F36DE7651B4DB3AD92C" +
        "A5C735D9401F86A8AF5790112217CF70E81C99C33E1FEDE9B69603B52E02069A44ADB9AACF5CF2803648DF8D1D48E33B6C97" +
        "A0F5C4FC9F5525EFBD12094603858D6AC72C2C31653D35E5E5BB5680BDB5D013A33BB71AB215AF7CB5B301B67AF0D3AA4064" +
        "49B069902BD0F108111E7DE5E89A1143F33035F532F7CD722AF2C255CAF3202B779028F376A5442189A5AB550D301B7855E1" +
        "4D25C30D789445D32150BCBD1EB591CABDA42EB2421AF5D247A7FABF2DCA77A37E4C4CBF38ED00BBE6E3FFEDAB8217EF2BB7" +
        "67722AB738D5A8E647BF1F8C488CB7BF55EF22C66DC7440B82F8399CDD4678950C9FC2D4761D99CB902B65D9F571AC59381D" +
        "C2ABE52008248F380FDD15674C94F62383A32942121E757DF77F260E0AB3F18F23E736A1F96BCFFD5337460205771F7F8428" +
        "D9B99BEAA81A4274A0480287B65F1084B19BE481B78418EDB32876EF92941F7E5DDD0CEEA6A5BCB440C8F4FBB5CDB235416A" +
        "D0C2CCA6919797BB052C5F8D2968AC2BEA9211846A0A2AFDC0C421B2C0F407DAD5FE4554293692F2D90E211A3BD21E2BDDA8" +
        "2F34A73751BF2DB08C67FE50C56261E6D7EBF5515631275E81DDC90EB696C6B53656EC20754AA767346F639AF1CD85563A16" +
        "C7502049DB65F62524CD4F126A01436AE500EA52F8B8F33F975D23891DAC9FBACB20570203010001";

    protected override bool ValidateCertificate(byte[] certificateData)
    {
        X509Certificate2 certificate = new X509Certificate2(certificateData);

        string pk = certificate.GetPublicKeyString();
        return pk == SRV_PUB_KEY;
    }
}
